Array stream1 = readFile(left);
Array stream2 = readFile(middle);
Array stream3 = readFile(right);
Array output = [];

while(stream.nextInput != null) {
    a = stream1.pop();
    b = stream2.pop();
    c = stream3.pop();

    output.push(c);
    output.push(b);
    output.push(a);
    output.push(a+b);
    output.push(b+c);
}

write.output;

